%Pakete;
%A4, Report, 12pt
\documentclass[ngerman,a4paper,12pt]{scrreprt}
\usepackage[a4paper, right=20mm, left=20mm,top=30mm, bottom=30mm, marginparsep=5mm, marginparwidth=5mm, headheight=7mm, headsep=15mm,footskip=15mm]{geometry}

%Papierausrichtungen
\usepackage{pdflscape}
\usepackage{lscape}

%Deutsche Umlaute, Schriftart, Deutsche Bezeichnungen
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[ngerman]{babel}

%quellcode
\usepackage{listings}

%tabellen
\usepackage{tabularx}

%listen und aufzählungen
\usepackage{paralist}

%farben
\usepackage[svgnames,table,hyperref]{xcolor}

%symbole
\usepackage{latexsym,textcomp}
\usepackage{amssymb}

%font
\usepackage{helvet}
\renewcommand{\familydefault}{\sfdefault}

%durch- und unterstreichen
\usepackage{ulem}

%Abkürzungsverzeichnisse
\usepackage[printonlyused]{acronym}

%Bilder
\usepackage{graphicx} %Bilder
\usepackage{float}	  %"Floating" Objects, Bilder, Tabellen...
\usepackage[space]{grffile} %Leerzechen Problem bei includegraphics
\usepackage{wallpaper} %Seitenhintergrund setzen
\usepackage{transparent} %Transparenz

%Tikz, Mindmaps, Trees
\usepackage{tikz}
\usetikzlibrary{mindmap,trees}
\usepackage{verbatim}

%for
\usepackage{forloop}
\usepackage{ifthen}

%Dokumenteigenschaften
\title{Summary InfSi2}
\author{Tobias Blaser}
\date{\today{}, Uster}


%Kopf- /Fusszeile
\usepackage{fancyhdr}
\usepackage{lastpage}

\pagestyle{fancy}
	\fancyhf{} %alle Kopf- und Fußzeilenfelder bereinigen
	\renewcommand{\headrulewidth}{0pt} %obere Trennlinie
	\fancyfoot[L]{\jobname} %Fusszeile links
	\fancyfoot[C]{Seite \thepage/\pageref{LastPage}} %Fusszeile mitte
	\fancyfoot[R]{\today{}} %Fusszeile rechts
	\renewcommand{\footrulewidth}{0.4pt} %untere Trennlinie

%Kopf-/ Fusszeile auf chapter page
\fancypagestyle{plain} {
	\fancyhf{} %alle Kopf- und Fußzeilenfelder bereinigen
	\renewcommand{\headrulewidth}{0pt} %obere Trennlinie
	\fancyfoot[L]{\jobname} %Fusszeile links
	\fancyfoot[C]{Seite \thepage/\pageref{LastPage}} %Fusszeile mitte
	\fancyfoot[R]{\today{}} %Fusszeile rechts
	\renewcommand{\footrulewidth}{0.4pt} %untere Trennlinie
}

\usepackage{changepage}

% Abkürzungen für Kapitel, Titel und Listen
\input{commands/shortcutsListAndChapter}
\input{commands/TextStructuringBoxes}

%links, verlinktes Inhaltsverzeichnis, PDF Inhaltsverzeichnis
\usepackage[bookmarks=true,
bookmarksopen=true,
bookmarksnumbered=true,
breaklinks=true,
colorlinks=true,
linkcolor=black,
anchorcolor=black,
citecolor=black,
filecolor=black,
menucolor=black,
pagecolor=black,
urlcolor=black
]{hyperref} % Paket muss unbedingt als letzes eingebunden werden!

\usepackage{graphicx}
\begin{document}

% Inhaltsverzeichnis
\tableofcontents
\clearpage

\ch{Repetition}

\se{Kryptographische stärke im 2013}
\exam{Schlüsselstärken wissen an Prüfung}

\ul
	\li Symetrische Verschlüsselung: 
		\ul
			\li AES \textbf{128bit}, 192bit, \textbf{256bit} \\
			\ra Es gibt keine Shortcut Attacken bei 128, nur Brute Force. 256 und 192 haben jeweils eine etwas kleinere Stärke (ca 220, 180) weil man durch das verwendete Gleichungssystem etwas effizienter als mit Brute Force angreifen kann.
			\li Twofish 
			\li 3DES 168bit (3x56bit) \ra Stärke 112bit (doppelte DES Veschlüsselung) \\
				\ra Es gibt eine Attacke von beiden Enden her, darum braucht 3DES in der Mitte noch die 3. DES Verschlüsselung und kommt auf eine Stärke von doppeltem DES
			\li Camellio
		\ulE
	\li Data Integrity (Hash): 
		\ul
			\li SHA-3 (Keccak) 224, 256, 384, 512bit \\
				\ra auf 64Bit Rechnern ist 512bit schneller als 256bit
			\li \textbf{SHA-2 (NIST)}
		\ulE
	\li Key Exchange (between peers):
		\ul
			\li DH \textbf{2048bit}, 1576bit \\
			\ra Aufwand wächst gegenüber symetrischen Verfahren mit der 3.Potenz des Modulus der Primzahl, daher Key viel länger
		\ulE
	\li Digital Signature: 
		\ul
			\li RSA \textbf{2048bit}, 4096bit \\
			\ra Root Server, die ein Zertifikat für 20 Jahre lösen, verwenden schon heute 4096
			\li DSA (Digital Signature Algorithm, erlaubt nur zu verschlüsseln nicht zu signieren) \\
			\ra mit eliptischen Kruven: ECDSA
		\ulE
	\li Public Key:
		\ul
			\li RSA 2048bit, 4096bit für langjährige Ausrichtung
			\li El Gamal (verwandt mit DH) 2048bit
		\ulE
	\li User Password: 22 Zeichen \ra 128bit, 12 absolutes Minimum
\ulE

\se{NSA Suites}
\img{img/v1.1.jpg}{NSA Suite B 128bit security (CONFIDENTIAL)}{0.75}{}
\img{img/v1.2.jpg}{NSA Suite B 192bit security (SECRET)}{0.75}{}

Alle Verfahren sollen gleich stark sein, damit es kein schwächstes Verfahren in der Kette gibt.

\ch{Elliptische Kurven}
\img{img/v1.3.jpg}{}{0.75}{}
\ul
	\li Polynom 3. Grades
	\li EC sind immer spiegelsymetrisch zur X-Achse, weil Quadratwurzeln immer zwei Lösungen besitzen
	\li Gute elliptische Kurve: Keine Nullstellen fallen zusammen, x\^3 besitzt 3 unterschiedliche Nullstellen.
	\li Operationen müssen Assoziativ sein
	\li Oft auch Kommutativ
\ulE

\expl{Algebraische Gruppe}{Zahlensystem, in dem bestimmte Regeln gelten. 
	\ul
		\li Wendet man auf Gruppenmitglieder Operationen an, so liegt das Resultat wieder innerhalb der Gruppe
		\li Jede Gruppe besitzt ein neutrales Element e
		\li Jede Gruppe besitzt ein inverses Element a
	\ulE}
\img{img/v1.4.jpg}{}{0.75}{}
\img{img/v1.5.jpg}{Punkte auf einer elliptischen Kurve, die eine Gruppe bilden}{0.75}{}
\ul
	\li Alle Elemente, die auf einer elliptischen Kruve liegen, bilden eine algebraische Gruppe.
	\li Gearbeitet wird mit Punktaddition:
		\ul
			\li Punkte werden mti Linie verbunden \ra neuer Punkt auf Line \ra spiegelung davon is Resultat
		\ulE
	\li Der Punkt im Unendlichen ist das neutrale Element
	\li P + das neutrale Element ergibt wieder P
	\li Um wie mit DH damit arbeiten zu können, muss ich einen Punkt mehrmals zu sich selbst addieren
\ulE
\img{img/v1.6.jpg}{Neutrales und inverses Element}{0.75}{}
\img{img/v1.7.jpg}{Punkt duplikation - einen Punkt zu sich selbst addieren}{0.75}{}
\img{img/v1.8.jpg}{Punkt Iteration, Addieren eines Punktes k-1 mal zu sich selbst}{0.75}{}
\img{img/v1.9.jpg}{}{0.75}{}

\se{Praktische Anwendung}
\img{img/v1.10.jpg}{}{0.75}{}
\ul
	\li Kurve wird bekannt gegeben: Primzahl b, Parameter a,b
	\li Startpunkt P auf Kurve wird auch bekannt gegeben
	\li Bob und Alis wählen eine Zahl a, die bestimmt, wie viel mal P mit sich selbst addiert wird \ra Bildpunkt 
	\li Bildpunkt wird öffentlich übertragen
	\li aus den übertragenene Elementen kann nur mit sehr grossem Aufwand a berechnet werden
	\li das Wachstum der geheimnisse a und b korreliert fast linear mit der Verschlüsselungsstärke
\ulE

\se{AEAD}
\ul
	\li Verschlüsselung + Hash in einem Schritt
	\li Gegenüber einzelner Verschlüsselung und einzelner Signaturerstellung viel schneller
	\li Kaum langsamer gegenüber nur Verschlüsselung
\ulE


\ch{Physical Layer Security}
Früher Verwendet:
\ul
	\li Voice Scrambling (Time Multiplex)
	\li Frequency Hopping
\ulE

\se{Quantenkryptographie}
Splitten von Photonen in zwei Photenen, die verschränkt sind.
\img{img/v2.1.jpg}{}{0.75}{}
\expl{Polarisiertes Licht}{Nach dem horizontalen oder vertikalen elektrischen Feld ausgerichtetes Licht}
\ul
	\li Nicht gemessene Photonen haben beide polarisierten Zustände
	\li Zwei Set von Filter: 0°, 90° (Sieht aus wie ein Schweizerkreuz) und 45°, 115°.
	\li Messen Empfänger und Sender gleich (polarisiert), so haben die beiden Photonen den gleichen Zustand.
	\li 2. Zufallsmessung
	\li Horcht jemand mit, so verändert er damit den Quantenzustand und die beiden Kommunikationsteilnehmer bemerken dies. \ra Bob erhält kein Photon
	\li Klaut Eve das Photon und speist ein anderes ein, so funktioniert dies nicht, weil verschränkte Photonen nicht dupliziert werden können.
	\li Diese Quanten laufen über eine sepparate Glasphaser
	\li Kommunikationsparter teil sich nicht mit, was sie gemessen haben, sondern mit welchen Filterset. Haben SIe mit unterschiedlichen Filtersets gemessen, so werden diese Photonen verworfen. \ra 50\% Ausschuss
	\li Wegen diesen 50\% Verwurf kann der Quantenkanal nicht für Streamcipher verwendet werden. Zudem ist der Schlüsselstrom ziemlich niederratig. \ra Quantenkanal wird nur für Session-Schlüsselaustausch verwendet.
	\li Problem mit Distanz: Repeathen nicht möglich.
\ulE

\se{BB84 Key Distribution System}
\ul
	\li Alice erzeugt normalePhotonen und sendet diese an Bob
	\li Photon wird moduliert
	\li Bob wählt zufällig Filterset
	\li Wenn Eve ein Photon klaut, kriegt Bob keines
	\li Nach gewisser Anzahl Photonen tauschen Bob und Alice das verwendete Filterset aus und Alice gibt die Modulation bekannt (orthogonal / 45° verschoben). \ra Nicht passende Filtersets werden verworfen
	\li Speist Eve zusätzliche Photonen ein, so kann dies detektiert werden
	\li Es ist praktisch unmöglich einen Laser zu bauen, der nur ein Photon ausgibt
	\li Problematisch, wenn der Laser mehr als ein Photon ausgibt, weil Eve dann eines der Photonen klaut. \ra Eve klaut natürlich immer eines, daher erhält Bob nur die Photonen, die mehrfach ausgesendet werden.
	\li Dämpfung in der Glasfaser: bei 10dB Dämpfung kommen nur noch 10\% an, bei 20db nur 1\%.
	\li Maximale Distanz: 1000km \ra 30dB Dämpfung
	\li Daher ist die Netodatenrate sehr tief und es fällt gar nicht auf, wenn Eve Photonen klaut.
\ulE

\img{img/v2.2.jpg}{}{0.75}{}

\sse{Erhältliche Systeme}
\img{img/v2.3.jpg}{Layer 2 Encription with Quantum Key Distribution}{0.75}{}
\ul
	\li Untersten Kanal ist Key Distribution Kanal (1Key/min)
	\li Basierend auf RR84 und SARG, bis 50km Distanz zwischen Ersatz Rechenzentrum
	\li 10Gbit/s mit AES-256
\ulE
\img{img/v2.4.jpg}{}{0.75}{}


\se{Schlüssel Material und Randoom Nummern}
\img{img/v2.5.jpg}{HMAC}{0.75}{}
\ul
	\li Dokument wird zusammen mit Key gehashed und das ganze erneut mit Outerkey zu MAC verarbeitet.
\ulE
\img{img/v2.6.jpg}{PRF pseudo randoom function}{0.75}{}
\ul
	\li Seed wird gehashed mit Secret zusammen
	\li Autput wird erneut als Input für Hash verwendet
	\li So wird Stück für Stück genügend Zufallsmaterial generiert
	\li Zur Sicherheit wird jeder Output am Schluss erneut gehashed, damit nicht auf den vorherigen Output zurückgeschlossen werden kann
	\li Entropie des keys (Secret) wird ``verdünnt'' auf den ganzen Bitstream \ra nimmt nicht zu
\ulE
\exam{PRF Funktion nicht genau kennen, nur wissen dass es ein Verdünnen von Schlüsselmaterial ist}

\sse{TLS1.1 Master secret}
\img{img/v2.7.jpg}{TLS 1.1 Master Secret Berechnung}{0.75}{}
\ul
	\li Premastersecret (echte Entropie) wird aufgeteilt und erste Hälfte durch PRF-MD5 durchgelassen, zweite Hälfte durch PRF-SHA-1 durchgelassen. \\
	 \li Grund dafür: Angst vor Fall von MD5, Angst vor Backdoor in SHA-1
	 \li Beide Teile werden anschliessend verknüpft
\ulE
\img{img/v2.8.jpg}{Generating TLS 1.1 Key Material}{0.75}{}


\se{Generieren von wahren randoom Numbers}
\ul
	\li Zeicheneingabe von Tastatur besitzt wenig Entropie \ra Verwendet wird die Zeit zwischen den Tastenschlägen
	\li Mausbewegung
	\li Rauschen aus der Soundkarte
	\li Zugriffszeiten auf die Harddisk (Schwankungen durch Luftturbulenzen in echanischen HD's)
	\li Am Besten möglichst viele Quellen zusammenhashen
\ulE
\important{Hashen erhöht die Entropie nicht! Verbessert nur die Statistik}
\expl{Entropie Generator Ausfall}{Muss detektiert werden, weil sonst ein Strom mit null Entropie empfangen wird.}

\sse{Hardware basierte wahre Random Generatoren}
\ul
	\li Jeder Halbleiter rauscht \ra Auf Prozessor wird Diode gesetzt, die durch Rauschen Zufallszahlen erzeugt
	\li Thermal Nose Sources
\ulE

\img{img/v2.9.jpg}{Photonengenerator, dessen Strom durch Spiegel umgelenkt werden}{0.75}{}
\img{img/v2.10.jpg}{}{0.75}{}

\sse{Randomness überprüfen und korrigieren}
\ul
	\li Problem: zu viele Nullen \ra Bits werden nach Auftrittswahrscheinlichkeit substituiert.
\ulE

\ch{Data Link Layer Security}
\se{EAP}
\img{img/v3.1.jpg}{Gerät ist entweder Suplicant oder Authentiater (Antragsteller oder Authentifizierer)}{0.75}{}

\definition{EAPOL}{EAP over LAN}
Gewünscht: Verschlüsseln der Trunkleitung zum Radiusserver

\se{IEEE 802.1AR -DevID}
\definition{DevID}{Secure Device ID}
\ul
	\li Jedes Gerät wird ab Werk mit Schlüssel für EC, RSA ausgeliefert
	\li In einem Rom gespeichert, kann nicht gelöscht werden
	\li Bereits ein Zertifikat gespeichert, welches vom Hardwarehersteller signiert wurde
	\li Lokaler Administrator kann beliebig viele Device ID's hinzufügens
	\li Befindet sich in geschütztem Chip
\ulE
\img{img/v3.2.jpg}{}{0.75}{}
\ul
	\li SHA 256 vorgeschrieben
	\li ANwendungen: EAP-TLS Authentisierung (Nicht User ID sondern Device ID)
	\li Mit TPM haben die meissten PC's bereits heute Möglichkeiten für eine DeviceID
\ulE

\se{MAC Layer Security}
\ul
	\li Verschlüsselung muss effizient sein wegen häufigem rekeying
	\li Bestimmte Benutzer werden zu Gruppen zusammengefast (Connectivity Association)
\ulE
\definition{CAK}{Connectivity Authentication Key}
\img{img/v3.3.jpg}{CA}{0.5}{}
\img{img/v3.4.jpg}{Secure Channel für jede Verbindung zwischen den Teilnehmern}{0.5}{}
\ul
	\li Jeder Channel besitzt einen eigenen Schlüssel (Channel sind gerichtet)
	\li Schlüsselwechsel muss fliegend geschehen können: Pakete werden mit altem Schlüssel verschlüsselt und irgendwann wird gewechselt
	\li Jedes Paket enthält Channel und welcher Schlüssel zum Entschlüsseln verwendet werden soll
\ulE
\img{img/v3.5.jpg}{Association Number legt fest, ob alter oder neuer Key verwendet wurde}{0.75}{}

\sse{Sonderfall Peer-Peer, Peer-AP}
\img{img/v3.6.jpg}{}{0.75}{}

\sse{MAC sec}
\img{img/v3.7.jpg}{MAC sec Frame Format}{0.75}{}
\ul
	\li Security Tag: 8Byte oder 16Byte
	\li VErschlüsselung: Paket wird mit AES im Countermode verschlüsselt
	\li ICV ist MAC, krypt. Checksumme (16Byte)
	\li Ethernet Frame wird gesprengt wie bei getaggten VLAN Paketen
	\li FCS: Checksumme auf Bitfehler
\ulE

\img{img/v3.8.jpg}{SecTag Format}{0.75}{}
\ul
	\li Ethertype für MACSec (> 1500)
	\li im TCI ist definiert, ob SCI (Secure Channel Identifiert) mitgeschickt wird \\
	\ra Wenn SCI aus der MAC Adresse berechnet werden kann, kann er weggelassen werden
	\li Hash von SCI wird übertragen, auch wenn SCI nicht übertragen wird
	\li Wenn Paket zu kurz für Kollisionsdetektion, wird Tagging NACH dem ICV eingefügt \\
		\ra Problem bei Ethernet ohne Längenfeld: Wo beginnt das Padding? Chechsumme falsch \ra Secure TAG enthält Länge im SL (Short Length) Field (Feld gibt an, wenn Paket kürzer als 64Byte, wie lange es ist)
	\li schutz gegen Replay Attacken: PN Feld enthält Paket Number
\ulE

\img{img/v3.9.jpg}{TCI - TAG Control Information}{0.75}{}
\ul
	\li Wenn Bit E gesetzt: Verschlüsselung, sonst nur Checksum
\ulE

\img{img/v3.10.jpg}{Verschlüsselung im AES Counter Mode, SAK und CAK bieten 128bit \ra durchgehend gleiche Verschlüsselungsstärke}{1}{}

\sse{MKA distributes random SAK using CAK}
\img{img/v3.11.jpg}{}{0.75}{}
\ul
	\li SAK wird für Hashing und Verschlüsselung gebraucht
	\li Hilfsschlüssel KEK werden zur Verteilung gebraucht
	\li Jeder Teilnehmer der Connectivity Association trägt einen Teil zum SAK bei
	\li CAK lebt für Jahre im Switch
	\li KEK wird abgelegt und auch ewig verwendet
	\li 
\ulE

\sse{CAK EAP}
\ul
	\li Statt fest hinterlegt wird der CAK vom EAP Server bezogen
	\li CAK wird von MSK (Master Secret Key) abgeleitet
	\li Key wird periodisch gewechselt \ra Key ist dynamisch
\ulE
\img{img/v3.12.jpg}{Pairwise CAKs usage to to distribute a Group CAK}{0.75}{}


\ch{Applicationsecurity}
\se{OWASP}
\sse{Zugriffsprinzipien}
5A:
\ul
	\li Accounting
	\li Allerting
	\li Auditing
	\li Authenticate
	\li Access Controll
\ulE
\img{img/v4.1.jpg}{}{0.75}{}

\sse{Identifizierung und Authentisierung}
\img{img/v4.2.jpg}{Web Architektur}{0.75}{}
\ul
	\li Http hat kein Gedächnis. Kann die aufeinanderfolgenden Requests nicht in Verbindung bringen. Mit übermittelten Sessionkeys können die Endstationen dies gewährleisten.
	\li Vorne (Tier1-Tier2) weiss man noch wer es ist, beim Zugriff auf Tier 3 wird es dann vergessen! \ra Angriffsmöglichkeit
\ulE

\sse{Sicherheitstechnologien}
% Folie mit Technologien (12) aus Lösungssatz
\ul
	\li TLS: Attacken auf alte Versionen, Falsches Zertifikat erzeugt Warnung, die einfach weggeklickt werden kann
	\li Authentication: What you have: bsp SMS, What you know: bsp Passwort, what you are: bsp Iris
\ulE
\img{img/v4.3.jpg}{OWASP Appsec Tutorial Series Episode 1}{0.75}{}
\exam{WHITEHAT SECURITY WEBSITE STATISTICS REPORT (How Does Your Website Security
	Stack Up Against Your Peers?), Summer 2012, 12th Edition \ra Prüfungsrelevant
	\img{img/v4.4.jpg}{Web Application Security Status}{0.5}{}
}
\exam{Fortsetzung:
	\img{img/v4.5.jpg}{likelihood that at least one vulnerability will appear in a website 	}{0.75}{}
	\img{img/v4.6.jpg}{Window of Exposure (2010)}{0.75}{}
}

\sse{CIA-Sicherheitsprobleme}
\ul
	\li Confidentiality: Jemand kann Daten anschauen auf dem Server, die nicht für ihn bestimmt sind (Passwörter, Domain verwalten, ...)
		\ul
			\li \textbf{Besonders schützenswerte Daten gemäss Gesetz}: Gesundheitsdaten, Rassenzugehörigkeit, Religionszugehörigkeit, Straffälle \ra müssen Verschlüsselt werden
			\li Kreditkarteninformationen fallen NICHT unter das Personendatenschutzgesetz.
			\li Nur Schützenswerte Daten müssen vom Betreiber nicht verschlüsselt werden.
			\li Datenschutz und Personendatenschutz (Person vor Missbrauch dieser Daten schützen) sind zwei komplett unterschiedliche Dinge!
		\ulE
	\li Integrity: 
		\ul
			\li Jemand kann Inhalte auf dem Server verwändern
			\li Nutzung des Webservers als Plattform zum Angriff anderer Rechner bzw. User
		\ulE
	\li Availability: Attacke legt Server lahm
\ulE
\img{img/v4.7.jpg}{ OWASP Top 10 Risk Rating Methodology}{0.75}{}

\sse{Risikoberechnung}
\img{img/v4.8.jpg}{OWASP Threat Agent = Capabilities + Intentions + Past Activities}{0.75}{}

\sss{Verletzlichkeitsfaktoren}
\ul
	\li  Ease of discovery
 	\li Ease of exploit
 	\li Awareness
 	\li Intrusion detection
\ulE

\sss{Technical Impact}
\ul
	\li  Loss of confidentiality
 	\li Loss of integrity
 	\li Loss of availability
 	\li Loss of accountability
\ulE

\sss{Business Impact Factor}
\ul
	\li Financial damage
 	\li Reputation damage (Image, Medien)
 	\li Non-compliance (Verträglich zu Gesetzen und Regeln, Erfüllen von Richtlinien)
 	\li Privacy violation (Personenfaten)
\ulE


\sse{Security Testing Guide}
\img{img/v4.9.jpg}{}{0.5}{}
\img{img/v4.10.jpg}{}{0.5}{}
\img{img/v4.11.jpg}{}{0.75}{}
\img{img/v4.12.jpg}{}{0.75}{}
\img{img/v4.13.jpg}{}{0.75}{}


\ch{Webanwendungssicherheit}
\img{img/v5.1.jpg}{}{0.75}{}
\uli{
	\li Die meissten Angriffe finden heute auf Anwendungsschicht statt.
	\li Keine sprechenden Fehlermeldungen im Frontent ausgeben.
}

\se{Injection}
\expl{Injection}{Jede Beschreibungssprache ist durch Injections verwundbar.}
\img{img/v5.2.jpg}{Protocols}{0.75}{}
\img{img/v5.3.jpg}{SQL Injection}{0.75}{}
\sse{Mögliche Lösungen}
\uli{
	\li Whitelist / Blacklist Patterns (Filtern)
	\li Prepared Statements
	\li Stored Procedures
	\li Escaping: Verhindern, dass Angreifer die Zeichen verwendet, die ihm den Wechsel von den Daten in die Beschreibungssprache ermöglichen.
	\li Least Privileges
}
\expl{Injection ohne Fehlermeldung}{Auch wenn keine Fehlermeldung ausgegeben wird, die hilfreich ist, kann man durch die Aufrufzeit Informationen erhalten \ra Wenn Passwort falsch braucht die Applikation möglicherweise länger als wenn Username falsch oder wenn alles Falsch geht es sehr schnell}


\sse{Wichtige Hash Parameter}
\definition{Hash Funktion}{[pre-Image]\ra(f)\ra[image]}
\uli{
	\li Collision resistence (Zwei beliebige Inputs dürfen nicht den gleichen Hash bilden)
	\li One Way
	\li Pre-Image resistence
	\li Second Pre-Image resistence (Ein zweites finden, dass den gleichen Hash bildet
}


\se{Authentisierung \& Session Management}
\expl{Unterschied Authentisierung und Autorisierung}{Authentisierung: Identitätstest (Was ich bin, habe und weiss), : Autorisierung: Erlaubte Aktionen ermitteln (Autor von welchen Aktionen)}
\definition{Basic Auth}{Browser schickt jedes Mal Zugangsdaten wieder mit. Es gibt keine Session}
\definition{DigestAuth}{Challenge / Respone}
\expl{Challenge Response Funktion}{
	\oli{
		\li Server generiert zufällige Challenge
		\li Client Hasht Passwort+Challenge
		\li Server überprüft Hast
	}
}
\definition{Form-Based Authentisierung}{Klassisch Eingabefeld mit Username/Password}
\definition{TLS-Based Authentitiserung}{Client Verschlüsselt Server Token mit Zertifikat, Server Überprüft Signatur mit Public Key von Client \ra Certificate Chain muss stimmen}

\sse{History-Back}
\uli{
	\li History-Back im Browser ermöglicht einem späteren Nutzer nochmal mit Benutzerdaten des vorherigen Users einzuloggen.
	\li Lösung: Nach Login Redirect vornehmen (Browser merkt sich bei Redirect POST Daten nicht)
}

\expl{Passwort error Delay}{Verzögerung bei falschem Passwort. Angriffsmöglichkeit: Passwort beibehalten und user durchprobieren.}

\sse{Session Attacks}
\uli{
	\li Session Sniffing
	\li Sessin Guessing
	\li Session Cache Stealing
	\li Session Fixation
	\li Session Hijacking
	\li Session Stealing Prevention
}


\ch{Anonymität}
Warum brauche ich Anonymität:
\uli{
	\li Wahrung der Privatsphäre
	\li Redefreiheit
	\li Anonyme Marktforschung
	\li Anonyme Informationssammlung
	\li Whistle-blowing
}

\se{Pseudonym}
\uli{
	\li E-mail Verkehr wird über zwischenstation umgeleitet
	\li Remailer entfernt sämtliche Spuren der ursprünglichen Identität
	\li Problem: Single Point of Vulnerability \ra Wenn Behörde Server beschlagnahmt, ist die Anonymität im Eimer
}
\img{img/v6.1.jpg}{}{0.75}{}

\se{Anonymisierungsnetzwerk (David Chaum's Cascade of Mixes)}
\uli{
	\li Verteilte Pseudonymserver
	\li Anonymisierungsnetzwerk
	\li Der Benutzer wählt \textbf{zufällig} einen Weg durch das Netzwerk \ra nur der Benutzer weis den Weg
	\li über Entry Knoten tritt Benutzerin Netzwerk ein, über Exit aus dem Netzwerk aus
	\li Der Exitknoten wird als erstes von einem Gericht in die Mangel genommen, wenn ein straffälliger Vorfall geschehen war.
	\li Knoten sollten möglichst in unterschiedlichen Ländern sein \ra Erschwert Rechtshilfegesuche
	\li Wenn der Datenverkehr verschlüsselt ist, so läuft ein Rechtshilfegesuch natürlich ins Leere.
}
\img{img/v6.2.jpg}{Benutzer wählt Kette A, E, C}{0.75}{}
\img{img/v6.3.jpg}{destom mehr Verkehr, desto Anonymer ist man unterwegs}{0.75}{}


\sse{Untraceability by using Public Key Cryptography}
\uli{
	\li Nachrichten können bereits an ihrer Meldungslänge erkannt werden \ra Kurze Meldungen werden auf 512 Byte gepadded, lange fragmentiert
}
\img{img/v6.4.jpg}{}{0.75}{}
\oli{
	\li Datenverkehr wird auf dem Client verschlüsselt mit PK des Exit Knoten \ra Exit Knoten kriegt Inhalt mit, wenn der Verkehr nicht End-zu-End Verschlüsselt ist.
	\li Nachricht inkl. Destinationsadresse von Exitknoten wird mit PK von C verschlüsselt
	\li Nachricht inkl. Destinationsadresse von C wird mit PK von E verschlüsselt.
	\li Nachricht inkl. Dest. Addr. von E wird mit PK von Entryknoten verschlüsselt.
}

\sse{Entschlüsselung}
\oli{
	\li A entfernt seine Adresse \ra Frei werdener Platz wird mit Zufallspadding gefüllt, anschliessend wird die Nachricht entschlüsselt
	\li E entfernt wieder seine IP, hängt Padding an und entschlüsselt Inhalt.
	\li ...
}

\sse{Mix KnotenFunktionen}
\img{img/v6.5.jpg}{}{0.5}{}
\uli{
	\li Entschlüsseln des Datenverkehrs
	\li Zeitliches mischen der Anfragen/Ausgaben \ra Eingehende Pakete können nicht mit Ausgehenden korreliert werden, weil sie in zufälliger Reihenfolge rauskomen
	\li Doppelte Pakete löschen (Replay Attacken) \\ Ein Anfreifer könnte ein eingehendes Paket kopieren und nochmal einspeisen. Durch überwachung des Ausgangsverkehr kann er anhand des doppelten Ausgangspaketes das Eingangspaket dem Ausgangspaket zuordnen
}

\sse{Antwort}
\uli{
	\li Retourverschlüsselung sehr komplexs
}

\sse{High Latency Anonymizer}
\uli{
	\li Grosser Puffer
	\li lange Verzögerung
	\li ziemlich sicher
}

\sse{Low-Latency Anonymizers}
\uli{
	\li Anfällig gegen Knotenüberwachung
	\li Man darf nicht zu lange die gleiche Kette bauchen (Tor wechselt häufig die Kette)
	\li Kleine oder gar keine Resorting Puffer
}


\sse{Tor}
\uli{
	\li Ursprünglich von der US Navy entwickelt
	\li Tor kann alle TCP basierten Dienste anonymisieren
	\li Setzt DH Sessionschlüssel ein \ra immer frisch generierte Schlüssel
	\li Es kann beliebig im Pfad ausgestiegen werden \ra Exitknoten weis nicht, das er einer ist
	\li Onion Proxy: Client, der Nur Verkehr ein speist
	\li Onion Router: Knoten
	\li Besser, wenn Cient selber auch Knoten, damit sein eigener Verkehr im Knotenverkehr versteckt ist.
	\li Zwischen den Knoten verwendet Tor TLS
}
\img{img/v6.6.jpg}{}{0.75}{}
\img{img/v6.7.jpg}{Tor Datenformat}{0.75}{}
\uli{
	\li Innerhalb des Netzwerkes gibt es ein standartisiertes Datenformat
	\li Datenverkehr wird auf dem gleichen Pfad wieder zurück gesendet
	\li Stream ID gilt End-zu-End
	\li CircID ermöglicht Zuordnung bei jedem Knoten zwischen Hin- und Retourverkehr
	\li Stream ID weis nur Exit Knoten
}

\img{img/v6.8.jpg}{Circuit}{0.75}{}
\uli{
	\li Stream ist doppelt verschlüsselt (für jeden Knoten einmal)
}

\sse{Anonymer Server}
\img{img/v6.9.jpg}{}{0.75}{}
\uli{
	\li Addresssequence muss in Forum bekannt gegeben werden
	\li User wählt Introduction Point und gibt geschlossenes Paket ab (Addresssequence)
	\li Introduction Point ist wie Exit Point, weiss jedoch um was es geht 
	\li Benutzer wählt Rendezvous Point, dieser hat überhaupt keine Ahnung, um was es geht
	\li Wenn Server antworten möchte, so baut er Verbindung zum Rendezvous Point auf
	\li Datenverkehr läuft über Rendezvous Point
}



\ch{Data Leak Protection}
\sse{Warum Daten schützen?}
\uli{
	\li Vertrauen
	\li Trade Secret (Geheimhaltung)
	\li Rechtliche Aspekte
	\li Bankgeheimnis
	\li Staatssicherheit (Geheimdienst hat je nach Land das Recht in allen Daten zu stöbern)
}

\img{img/v7.1.jpg}{Wo befinden sich Daten in einer Firma}{1}{}
\sse{Data leakage}
\img{img/v7.2.jpg}{Wo können Daten geleakt werden}{1}{}

\sse{Data Leak Protection}
\img{img/v7.3.jpg}{}{0.75}{}
\uli{
	\li Egress Controll: Was verlässt das Unternehmen
	\li Usage Control: z.B. DRM
}

\se{Egress Control}
\img{img/v7.4.jpg}{Datenkontrolle}{1}{}
\img{img/v7.5.jpg}{Test Daten Anonymisierungsarten}{0.75}{}
\img{img/v7.6.jpg}{Egress Control Example}{0.75}{}

\sse{Information Rights Management IRM}
$IRM = Usage Control + Encryption$ \\
\ra Controllieren, was mit Informatioin geschieht

\sse{AD RMS}
\uli{
	\li Active Directory basiertes Dateisystem-IRM mit MS Office Support
	\li Rechte werden direkt in der Datei gespeichert
}
\img{img/v7.7.jpg}{Publish and Consume Files}{0.75}{}


\ch{VPN}

\definition{VPN}{Virtual Private Network}
\se{Point to Point Protocol PPP}
\stdImg{v8.1}{PPP}
\uli{
	\li  Authentication using PAP (password), CHAP (challenge/response), or the
Extensible Authentication Protocol (EAP) supporting e.g. token cards
}
\stdImg{v8.2}{PPP Encryption Control Protocol}

\se{Layer2/3/4 Tunneling}
\stdImg{v8.3}{L2TP Compulsory Mode} 
\stdImg{v8.4}{L2TP Voluntary Mode}
\stdImg{v8.5}{Layer3 tunneling IPsec based}
\stdImg{v8.6}{L2TP  over IPsec - Voluntary Modes}
\stdImg{v8.7}{Layer4 Tunnel based on TLS}
\stdImg{v8.8}{L2/3/4 Tunneling Comparison}

\se{MPLS}
\definition{MPLS}{Multi Protocol Label Switching}
\stdImg{v8.9}{MPLS Based VPN}
\uli{
	\li VPN Paet erhält im ISP Backbone beim Eintritt vor das IP Paket ein Label. Dadurch kann es ohne Auslesen der IP Informationen geroutet werden.
	\li Ein weiteres Label definiert den Routingweg und wird von Hop zu Hop verändert
	\li Label based Routing ist effizienter und ermöglich es einfache statistiken zu erheben
}
\stdImg{v8.10}{MPLS L2 Shim Header}
\uli{
	\li Shim Header is inserted after the DLL Header and before the IP Header (between L2 and L3)
	\li Type Of Service Field ist ähnlich dem Type of Service Field des IP Headers
	\li Das TTL Field übernimmt die gleiche Funktion wie das Time To Live Field des IP Headers
}

\se{IPsec Transport Mode}
\stdImg{v8.11}{IPsec Transport}
\uli{
	\li IP Datagramms sollten verschlüsselt und authentifiziert sein, damit IP Spoofing und hijacking sowie Modifikationen des Paketes unmöglich sind.
	\li Verschlüsselung ohne Authentication ist verwundbar durch verschiedene Attacken
}
\stdImg{v8.12}{IP Authentication Header AH}
\uli{
	\li Schützt Header und Payload gegen Modifications mittels MAC
	\li Header hat die Struktur einer IPv6 Header Extension, funktioniert allerdinga auch unter IPv4
	\li AH Kann beliebige Transport Layer Protokolle schützen
}
\stdImg{v8.13}{IP Encapsulated Secure Payload ESP}
\uli{
	\li  ESP encrypts the transport payload of the IP datagram using a strong symmetric
encryption algorithm, (AES, CAMELLIA, 3DES, etc.).
	\li Trailer füllt Paket auf 4 Byte Blöcke auf.
	\li Initialisierungsvektor für die Verschlüsselung, falls ein Paket verloren geht
	\li Struktur einer IPv6 Extension
}

\se{IPsec Tunnel Mode}
\stdImg{v8.14}{VPN}
\uli{
	\li Connect Subnet's together over unsecure channels
	\li Benutzt Verschlüsselten und Authentifizierten IPsec Tunnel
	\li Hinter dem Secure Gateway können lokale, nicht im Internet addressierbare Adressen verwendet werden, die im Internet nicht addressierbar sind
}
\stdImg{v8.15}{VPN Package}
\stdImg{v8.16}{ESP Header, Payload and Trailer}
\stdImg{v8.17}{Authenticated Encryption with Associated Data (AEAD)}
\stdImg{v8.18}{IPsec Tunnel Mode AEAD Packet Overhead}
\stdImg{v8.19}{IPsec Tunnel using AH}








\end{document}
